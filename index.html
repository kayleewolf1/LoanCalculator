<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Loan Calculator</h1>
        <form id="loanForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="loanAmount">Loan Amount ($)</label>
                    <input type="text" id="loanAmount" name="loanAmount" placeholder="Enter loan amount">
                    <div class="error" id="loanAmountError"></div>
                </div>

                <div class="form-group">
                    <label for="purchasePrice">Purchase Price ($)</label>
                    <input type="text" id="purchasePrice" name="purchasePrice" placeholder="Enter purchase price">
                    <div class="error" id="purchasePriceError"></div>
                </div>

                <div class="form-group">
                    <label for="ltv">LTV (%)</label>
                    <input type="text" id="ltv" name="ltv" readonly>
                </div>

                <div class="form-group">
                    <label for="fico">FICO Score</label>
                    <input type="number" id="fico" name="fico" placeholder="Enter FICO score" min="300" max="850">
                    <div class="error" id="ficoError"></div>
                </div>

                <div class="form-group">
                    <label for="propertyType">Property Type</label>
                    <select id="propertyType" name="propertyType">
                        <option value="single-family">Single Family</option>
                        <option value="multi-family">Multi Family</option>
                        <option value="condo">Condo</option>
                        <option value="townhouse">Townhouse</option>
                        <option value="manufactured">Manufactured</option>
                        <option value="commercial">Commercial</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="state">State</label>
                    <select id="state" name="state">
                        <option value="">Select a state</option>
                    </select>
                    <div class="error" id="stateError"></div>
                </div>
            </div>

            <button type="submit">Calculate</button>
        </form>

        <div id="results">
            <h2>Stored Variables:</h2>
            <div class="results-grid">
                <div class="result-item" id="resultLoanAmount"></div>
                <div class="result-item" id="resultPurchasePrice"></div>
                <div class="result-item" id="resultLTV"></div>
                <div class="result-item" id="resultFICO"></div>
                <div class="result-item" id="resultPropertyType"></div>
                <div class="result-item" id="resultState"></div>
            </div>
        </div>
    </div>

    <script>
        // List of US states
        const states = [
            'AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA',
            'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD',
            'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ',
            'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC',
            'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY'
        ];

        // Populate states dropdown
        const stateSelect = document.getElementById('state');
        states.forEach(state => {
            const option = document.createElement('option');
            option.value = state;
            option.textContent = state;
            stateSelect.appendChild(option);
        });

        // Format currency input
        function formatCurrency(input) {
            // Remove all characters except numbers
            let value = input.value.replace(/[^\d]/g, '');
            
            // Format with commas
            if (value.length > 0) {
                value = parseInt(value).toLocaleString();
            }
            
            input.value = value;
        }

        // Calculate LTV
        function calculateLTV() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value.replace(/,/g, '')) || 0;
            const purchasePrice = parseFloat(document.getElementById('purchasePrice').value.replace(/,/g, '')) || 0;
            
            if (purchasePrice > 0) {
                const ltv = ((loanAmount / purchasePrice) * 100).toFixed(2);
                document.getElementById('ltv').value = ltv;
            }
        }

        // Add event listeners for currency formatting and LTV calculation
        document.getElementById('loanAmount').addEventListener('input', function() {
            formatCurrency(this);
            calculateLTV();
        });

        document.getElementById('purchasePrice').addEventListener('input', function() {
            formatCurrency(this);
            calculateLTV();
        });

        // Form validation and submission
        document.getElementById('loanForm').addEventListener('submit', function(e) {
            e.preventDefault();
            let isValid = true;
            
            // Clear previous errors
            document.querySelectorAll('.error').forEach(error => error.textContent = '');

            // Validate Loan Amount
            const loanAmount = document.getElementById('loanAmount').value;
            if (!loanAmount) {
                document.getElementById('loanAmountError').textContent = 'Loan amount is required';
                isValid = false;
            }

            // Validate Purchase Price
            const purchasePrice = document.getElementById('purchasePrice').value;
            if (!purchasePrice) {
                document.getElementById('purchasePriceError').textContent = 'Purchase price is required';
                isValid = false;
            }

            // Validate FICO
            const fico = document.getElementById('fico').value;
            if (!fico) {
                document.getElementById('ficoError').textContent = 'FICO score is required';
                isValid = false;
            } else if (fico < 300 || fico > 850) {
                document.getElementById('ficoError').textContent = 'FICO score must be between 300 and 850';
                isValid = false;
            }

            // Validate State
            const state = document.getElementById('state').value;
            if (!state) {
                document.getElementById('stateError').textContent = 'State is required';
                isValid = false;
            }

            if (isValid) {
                // Store and display results
                const results = {
                    loanAmount: parseFloat(loanAmount.replace(/,/g, '')),
                    purchasePrice: parseFloat(purchasePrice.replace(/,/g, '')),
                    ltv: document.getElementById('ltv').value,
                    fico: parseInt(fico),
                    propertyType: document.getElementById('propertyType').value,
                    state: state
                };

                // Display results
                document.getElementById('resultLoanAmount').textContent = `Loan Amount: $${results.loanAmount.toLocaleString()}`;
                document.getElementById('resultPurchasePrice').textContent = `Purchase Price: $${results.purchasePrice.toLocaleString()}`;
                document.getElementById('resultLTV').textContent = `LTV: ${results.ltv}%`;
                document.getElementById('resultFICO').textContent = `FICO Score: ${results.fico}`;
                document.getElementById('resultPropertyType').textContent = `Property Type: ${results.propertyType.split('-').map(word => 
                    word.charAt(0).toUpperCase() + word.slice(1)
                ).join(' ')}`;
                document.getElementById('resultState').textContent = `State: ${results.state}`;

                // Show results section
                document.getElementById('results').classList.add('show');

                // Store in variables (you can use these values for further calculations)
                window.loanVariables = results;
                console.log('Stored variables:', results);
            }
        });
    </script>
</body>
</html>